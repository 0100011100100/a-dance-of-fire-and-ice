<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <title>地图生成器</title>
        <style>
            html,
            body {
                margin: 0;
                padding: 0;
                width: 200%;
            }
            .row {
                height: 40px;
            }
            .item {
                display: inline-block;
                width: 40px;
                height: 40px;
                border: 1px solid #2ad;
                box-sizing: border-box;
                font-size: 12px;
                text-align: center;
                line-height: 40px;
            }
            .checked {
                background: #2ad;
                color: #fff;
            }
            .item:hover {
                background: yellow;
                color: #2ad;
            }
        </style>
    </head>
    <body>
        <div id="root">
            <div>
                <button @click="exportToConsole">导出到console</button>
            </div>
            <div v-for="(item,y) in arr" class="row">
                <div
                    class="item"
                    :class="{ checked: !!~findItemIndex(x, y) }"
                    v-for="(xx,x) in arr[y]"
                    @click="toggleItem(x,y)"
                >
                    {{ getTextByPoint(x, y) }}
                </div>
            </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
        <script>
            new window['Vue']({
                el: '#root',
                data() {
                    return {
                        arr: [],
                        list: []
                    };
                },
                methods: {
                    toggleItem(x, y) {
                        const index = this.findItemIndex(x, y);
                        if (index > -1) {
                            this.list.splice(index, 1);
                            return;
                        }
                        this.list.push({ x: x, y: y });
                    },
                    findItemIndex(x, y) {
                        for (var i = 0; i < this.list.length; i++) {
                            var item = this.list[i];
                            if (item.x === x && item.y === y) {
                                return i;
                            }
                        }
                        return -1;
                    },
                    getTextByPoint(x, y) {
                        const index = this.findItemIndex(x, y);
                        if (~index) {
                            return index + 1;
                        }
                        return x + ',' + y;
                    },
                    exportToConsole() {
                        window.list = this.list;
                        console.log('在list变量中');
                    },
                    save() {
                        window.localStorage.setItem(
                            'list',
                            JSON.stringify(this.list)
                        );
                    },
                    restore() {
                        try {
                            var list = JSON.parse(
                                window.localStorage.getItem('list')
                            );
                            this.list = list;
                        } catch (ex) {}
                    }
                },
                watch: {
                    list() {
                        this.save();
                    }
                },
                created() {
                    window.ele = this;
                    // 初始化空白地图
                    for (var y = 0; y < 60; y++) {
                        var list = [];
                        for (var x = 0; x < 60; x++) {
                            list.push(0);
                        }
                        this.arr.push(list);
                    }
                    this.restore();
                }
            });
        </script>
        <script>
        var cacheList=[{"x":22,"y":50},{"x":23,"y":50},{"x":24,"y":50},{"x":25,"y":50},{"x":26,"y":50},{"x":27,"y":50},{"x":28,"y":50},{"x":29,"y":50},{"x":30,"y":50},{"x":31,"y":50},{"x":32,"y":50},{"x":33,"y":50},{"x":33,"y":49},{"x":34,"y":49},{"x":34,"y":50},{"x":35,"y":50},{"x":36,"y":50},{"x":37,"y":50},{"x":38,"y":50},{"x":39,"y":50},{"x":40,"y":50},{"x":41,"y":50},{"x":41,"y":49},{"x":40,"y":49},{"x":40,"y":48},{"x":40,"y":47},{"x":41,"y":47},{"x":42,"y":47},{"x":43,"y":47},{"x":44,"y":47},{"x":44,"y":46},{"x":43,"y":46},{"x":43,"y":45},{"x":43,"y":44},{"x":44,"y":44},{"x":45,"y":44},{"x":46,"y":44},{"x":46,"y":43},{"x":45,"y":43},{"x":45,"y":42},{"x":45,"y":41},{"x":46,"y":41},{"x":47,"y":41},{"x":48,"y":41},{"x":48,"y":40},{"x":47,"y":40},{"x":47,"y":39},{"x":47,"y":38},{"x":48,"y":38},{"x":49,"y":38},{"x":50,"y":38},{"x":50,"y":37},{"x":49,"y":37},{"x":49,"y":36},{"x":49,"y":35},{"x":49,"y":34},{"x":49,"y":33},{"x":49,"y":32},{"x":48,"y":32},{"x":47,"y":32},{"x":46,"y":32},{"x":46,"y":33},{"x":47,"y":33},{"x":47,"y":34},{"x":47,"y":35},{"x":46,"y":35},{"x":45,"y":35},{"x":44,"y":35},{"x":44,"y":36},{"x":45,"y":36},{"x":45,"y":37},{"x":45,"y":38},{"x":44,"y":38},{"x":43,"y":38},{"x":42,"y":38},{"x":42,"y":39},{"x":43,"y":39},{"x":43,"y":40},{"x":43,"y":41},{"x":42,"y":41},{"x":41,"y":41},{"x":40,"y":41},{"x":40,"y":42}];
        </script>
    </body>
</html>
